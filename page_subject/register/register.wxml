<!--page_subject/register/register.wxml-->
<view class="register-container">
  <!-- 頂部導航欄 -->
  <nav-bar title="注册" bgColor="#083869" titleColor="#fff" bind:onBack="onBack"></nav-bar>

  <!-- 主要內容區域 -->
  <view class="main-content">
    <view class="title">注册新账号</view>
    
    <!-- 輸入表單 -->
    <view class="form-container">
      <!-- 手機號輸入 -->
      <view class="input-group">
        <input class="input-field" 
               placeholder="输入手机号" 
               type="number" 
               maxlength="11"
               value="{{phone}}"
               bindinput="onPhoneInput"
               keyboard-type="number" />
      </view>

      <!-- 驗證碼輸入 -->
      <view class="input-group verification-group">
        <input class="input-field verification-input" 
               placeholder="输入验证码" 
               type="number" 
               maxlength="4"
               value="{{verificationCode}}"
               bindinput="onVerificationInput"
               keyboard-type="number" />
        <view class="verification-btn {{canGetCode ? '' : 'disabled'}}" 
              bindtap="getVerificationCode">
          {{countdown > 0 ? countdown + 's' : '获取验证码'}}
        </view>
      </view>

      <!-- 密碼輸入 -->
      <view class="input-group">
        <input class="input-field" 
               type="text"
               password="{{!showPassword}}"
               placeholder="输入密码" 
               value="{{password}}"
               bindinput="onPasswordInput"
               bindfocus="onPasswordFocus"
               bindblur="onPasswordBlur"
               confirm-type="done"
               cursor-spacing="20"
               adjust-position="{{true}}"
               keyboard-type="text"
               always-embed="{{true}}"
               auto-blur="{{false}}"
               hold-keyboard="{{false}}" />
        <view class="eye-icon" bindtap="togglePasswordVisibility">
          <image class="eye-image" src="{{showPassword ? '/static/eye.png' : '/static/eye_slash.png'}}" mode="aspectFit"></image>
        </view>
      </view>
      <!-- 密碼格式提示 -->
      <view class="password-tip">
        <text class="tip-text">密码要求：至少6位，包含数字和字母</text>
      </view>

      <!-- 確認密碼輸入 -->
      <view class="input-group">
        <input class="input-field" 
               type="text"
               password="{{!showConfirmPassword}}"
               placeholder="请再次输入密码" 
               value="{{confirmPassword}}"
               bindinput="onConfirmPasswordInput"
               bindfocus="onConfirmPasswordFocus"
               bindblur="onConfirmPasswordBlur"
               confirm-type="done"
               cursor-spacing="20"
               adjust-position="{{true}}"
               keyboard-type="text"
               always-embed="{{true}}"
               auto-blur="{{false}}"
               hold-keyboard="{{false}}" />
        <view class="eye-icon" bindtap="toggleConfirmPasswordVisibility">
          <image class="eye-image" src="{{showConfirmPassword ? '/static/eye.png' : '/static/eye_slash.png'}}" mode="aspectFit"></image>
        </view>
      </view>

      <!-- 協議勾選 -->
      <view class="agreement-container">
        <checkbox class="agreement-checkbox" 
                  checked="{{agreedToTerms}}" 
                  bindtap="toggleAgreement"></checkbox>
        <text class="agreement-text">已阅读并同意</text>
        <text class="link-text" bindtap="viewServiceAgreement">《服务协议》</text>
        <text class="agreement-text">和</text>
        <text class="link-text" bindtap="viewPrivacyPolicy">《隐私协议》</text>
      </view>

      <!-- 註冊按鈕 -->
      <button class="register-btn {{canRegister ? 'active' : 'disabled'}}" 
              bindtap="handleRegister" 
              disabled="{{!canRegister}}">
        注册
      </button>
    </view>
  </view>
</view>

<!-- 协议查看器组件 -->
<protocol-viewer 
  protocolType="{{currentProtocolType}}"
  visible="{{showProtocolViewer}}"
  bind:close="onCloseProtocolViewer"
/>